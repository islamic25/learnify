<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Learnify - Practice Quizzes</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
        }
        
        body {
            background-color: #f8fafc;
            color: #334155;
            line-height: 1.6;
            transition: background-color 0.3s ease;
        }
        
        .container {
            max-width: 480px;
            margin: 0 auto;
            padding: 20px;
            background-color: white;
            min-height: 100vh;
            box-shadow: 0 0 30px rgba(0, 0, 0, 0.05);
            position: relative;
            overflow-x: hidden;
        }
        
        /* Header Styles */
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding-top: 10px;
            animation: fadeIn 0.8s ease;
        }
        
        .header h1 {
            font-size: 32px;
            font-weight: 700;
            background: linear-gradient(135deg, #1e293b, #3b82f6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 8px;
        }
        
        .header p {
            color: #64748b;
            font-size: 16px;
            font-weight: 400;
        }
        
        /* Category Cards */
        .categories {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-bottom: 30px;
            animation: slideUp 0.6s ease;
        }
        
        .category-card {
            background: white;
            border-radius: 20px;
            padding: 24px;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.08);
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
            cursor: pointer;
            border: 1px solid #f1f5f9;
        }
        
        .category-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 25px rgba(0, 0, 0, 0.15);
        }
        
        .category-card.mdcat {
            background: linear-gradient(135deg, #f0fdf4, #ffffff);
        }
        
        .category-card.ecat {
            background: linear-gradient(135deg, #eff6ff, #ffffff);
        }
        
        .icon-container {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 16px;
            font-size: 28px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }
        
        .mdcat .icon-container {
            background: linear-gradient(135deg, #10b981, #34d399);
        }
        
        .ecat .icon-container {
            background: linear-gradient(135deg, #3b82f6, #60a5fa);
        }
        
        .card-title {
            font-size: 22px;
            font-weight: 600;
            margin-bottom: 8px;
            color: #1e293b;
        }
        
        .card-desc {
            color: #64748b;
            font-size: 14px;
            margin-bottom: 16px;
            line-height: 1.5;
        }
        
        .card-stats {
            display: flex;
            justify-content: space-between;
            color: #94a3b8;
            font-size: 14px;
            font-weight: 500;
        }
        
        .pattern {
            position: absolute;
            top: 0;
            right: 0;
            width: 120px;
            height: 120px;
            opacity: 0.05;
            background-size: contain;
            background-repeat: no-repeat;
        }
        
        .mdcat .pattern {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='100' height='100' viewBox='0 0 24 24' fill='none' stroke='%2310b981' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z'%3E%3C/path%3E%3C/svg%3E");
        }
        
        .ecat .pattern {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='100' height='100' viewBox='0 0 24 24' fill='none' stroke='%233b82f6' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z'%3E%3C/path%3E%3C/svg%3E");
        }
        
        /* Quiz Screen */
        .quiz-screen {
            display: none;
            animation: fadeIn 0.5s ease;
        }
        
        .nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .nav-btn {
            background: #f1f5f9;
            border: none;
            border-radius: 12px;
            padding: 10px 16px;
            font-size: 14px;
            color: #64748b;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 5px;
            font-weight: 500;
        }
        
        .nav-btn:hover {
            background: #e2e8f0;
            color: #475569;
        }
        
        .timer {
            font-size: 16px;
            font-weight: 600;
            color: #ef4444;
            background: #fef2f2;
            padding: 6px 12px;
            border-radius: 20px;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .question-counter {
            font-size: 14px;
            color: #64748b;
            font-weight: 500;
        }
        
        .progress-container {
            margin-bottom: 30px;
        }
        
        .progress-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 14px;
            color: #64748b;
        }
        
        .progress-bar {
            height: 8px;
            background-color: #e2e8f0;
            border-radius: 10px;
            overflow: hidden;
        }
        
        .progress {
            height: 100%;
            background: linear-gradient(90deg, #3b82f6, #60a5fa);
            border-radius: 10px;
            width: 30%;
            transition: width 0.5s ease;
        }
        
        .question {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 24px;
            line-height: 1.5;
            color: #1e293b;
        }
        
        .options {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-bottom: 30px;
        }
        
        .option {
            background-color: #f8fafc;
            border: 2px solid #e2e8f0;
            border-radius: 14px;
            padding: 16px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-weight: 500;
            color: #475569;
        }
        
        .option:hover {
            background-color: #f1f5f9;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
        }
        
        .option.selected {
            background-color: #dbeafe;
            border-color: #3b82f6;
            color: #1e40af;
            transform: scale(1.02);
        }
        
        .option.correct {
            background-color: #d1fae5;
            border-color: #10b981;
            color: #065f46;
        }
        
        .option.incorrect {
            background-color: #fee2e2;
            border-color: #ef4444;
            color: #991b1b;
        }
        
        .next-btn {
            background: linear-gradient(135deg, #3b82f6, #60a5fa);
            color: white;
            border: none;
            border-radius: 14px;
            padding: 18px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
        }
        
        .next-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(59, 130, 246, 0.4);
        }
        
        .next-btn:active {
            transform: translateY(0);
        }
        
        .submit-btn {
            background: linear-gradient(135deg, #10b981, #34d399);
        }
        
        .submit-btn:hover {
            box-shadow: 0 6px 15px rgba(16, 185, 129, 0.4);
        }
        
        /* Results Screen */
        .results-screen {
            display: none;
            text-align: center;
            padding: 20px 0;
            animation: fadeIn 0.8s ease;
        }
        
        .result-icon {
            font-size: 80px;
            margin-bottom: 20px;
            animation: bounce 1s ease;
        }
        
        .score-container {
            background: linear-gradient(135deg, #f0fdf9, #f8fafc);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.05);
        }
        
        .score {
            font-size: 56px;
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 8px;
            background: linear-gradient(135deg, #1e293b, #3b82f6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .percentage {
            font-size: 24px;
            color: #10b981;
            margin-bottom: 16px;
            font-weight: 600;
        }
        
        .message {
            font-size: 18px;
            margin-bottom: 30px;
            color: #475569;
            font-weight: 500;
        }
        
        .result-details {
            display: flex;
            justify-content: space-around;
            margin-bottom: 30px;
            background: #f8fafc;
            padding: 15px;
            border-radius: 14px;
        }
        
        .result-item {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .result-value {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .result-label {
            font-size: 14px;
            color: #64748b;
        }
        
        .correct .result-value {
            color: #10b981;
        }
        
        .wrong .result-value {
            color: #ef4444;
        }
        
        .result-buttons {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .result-btn {
            padding: 16px;
            border-radius: 14px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
        }
        
        .retry-btn {
            background: linear-gradient(135deg, #10b981, #34d399);
            color: white;
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
        }
        
        .retry-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(16, 185, 129, 0.4);
        }
        
        .share-btn {
            background-color: white;
            color: #475569;
            border: 2px solid #e2e8f0;
        }
        
        .share-btn:hover {
            background-color: #f8fafc;
            border-color: #cbd5e1;
            transform: translateY(-2px);
        }
        
        .back-btn {
            background-color: white;
            color: #475569;
            border: 2px solid #e2e8f0;
        }
        
        .back-btn:hover {
            background-color: #f8fafc;
            border-color: #cbd5e1;
            transform: translateY(-2px);
        }
        
        /* Loading Screen */
        .loading-screen {
            display: none;
            text-align: center;
            padding: 50px 0;
        }
        
        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid #e2e8f0;
            border-top: 5px solid #3b82f6;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        
        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes slideUp {
            from { 
                opacity: 0;
                transform: translateY(20px);
            }
            to { 
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {
                transform: translateY(0);
            }
            40% {
                transform: translateY(-10px);
            }
            60% {
                transform: translateY(-5px);
            }
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Responsive adjustments */
        @media (max-width: 480px) {
            .container {
                padding: 15px;
            }
            
            .header h1 {
                font-size: 28px;
            }
            
            .category-card {
                padding: 20px;
            }
            
            .question {
                font-size: 18px;
            }
            
            .result-details {
                flex-direction: column;
                gap: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Main Categories Screen -->
        <div id="categories-screen">
            <div class="header">
                <h1>Learnify Quizzes</h1>
                <p>Prepare for your entry tests with our daily practice quizzes</p>
            </div>
            
            <div class="categories">
                <div class="category-card mdcat" onclick="openQuiz('MDCAT')">
                    <div class="pattern"></div>
                    <div class="icon-container">🎓</div>
                    <div class="card-title">MDCAT Quiz</div>
                    <div class="card-desc">Medical and Dental College Admission Test preparation with comprehensive questions.</div>
                    <div class="card-stats">
                        <span>50 Questions</span>
                        <span>Daily Updates</span>
                    </div>
                </div>
                
                <div class="category-card ecat" onclick="openQuiz('ECAT')">
                    <div class="pattern"></div>
                    <div class="icon-container">🧮</div>
                    <div class="card-title">ECAT Quiz</div>
                    <div class="card-desc">Engineering College Admission Test practice with detailed solutions.</div>
                    <div class="card-stats">
                        <span>50 Questions</span>
                        <span>Daily Updates</span>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Loading Screen -->
        <div id="loading-screen" class="loading-screen">
            <div class="spinner"></div>
            <h3>Loading Today's Questions</h3>
            <p>Please wait while we fetch the latest quiz...</p>
        </div>
        
        <!-- Quiz Screen -->
        <div id="quiz-screen" class="quiz-screen">
            <div class="nav">
                <button class="nav-btn" onclick="backToCategories()">← Back</button>
                <div class="timer" id="timer">⏱️ 15:00</div>
                <div class="question-counter" id="question-counter">Question 1 of 50</div>
            </div>
            
            <div class="progress-container">
                <div class="progress-info">
                    <span>Progress</span>
                    <span id="progress-percent">2%</span>
                </div>
                <div class="progress-bar">
                    <div class="progress" id="progress-bar"></div>
                </div>
            </div>
            
            <div class="question" id="question-text">
                Loading question...
            </div>
            
            <div class="options" id="options-container">
                <!-- Options will be populated by JavaScript -->
            </div>
            
            <button class="next-btn" id="next-btn" onclick="nextQuestion()">Next Question</button>
        </div>
        
        <!-- Results Screen -->
        <div id="results-screen" class="results-screen">
            <div class="result-icon" id="result-icon">🎉</div>
            
            <div class="score-container">
                <div class="score" id="score-text">0/50</div>
                <div class="percentage" id="percentage-text">0%</div>
            </div>
            
            <div class="message" id="result-message">Keep Practicing for Success 🚀</div>
            
            <div class="result-details">
                <div class="result-item correct">
                    <div class="result-value" id="correct-answers">0</div>
                    <div class="result-label">Correct</div>
                </div>
                <div class="result-item wrong">
                    <div class="result-value" id="wrong-answers">0</div>
                    <div class="result-label">Wrong</div>
                </div>
            </div>
            
            <div class="result-buttons">
                <button class="result-btn retry-btn" onclick="retryQuiz()">Retry Quiz</button>
                <button class="result-btn share-btn">Share Result</button>
                <button class="result-btn back-btn" onclick="backToCategories()">Back to Categories</button>
            </div>
        </div>
    </div>

    <script>
        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBzDvBjcm56XutOD0l_vOnWO0EqGrrj3dw",
            authDomain: "explore-products-e7afb.firebaseapp.com",
            projectId: "explore-products-e7afb",
            storageBucket: "explore-products-e7afb.firebasestorage.app",
            messagingSenderId: "753462167322",
            appId: "1:753462167322:web:aab56a193e231277accea3",
            measurementId: "G-T4KP9YEY4X"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // Global variables
        let currentCategory = '';
        let questions = [];
        let currentQuestionIndex = 0;
        let userAnswers = [];
        let timerInterval;
        let timeLeft = 15 * 60; // 15 minutes in seconds

        // Screen elements
        const categoriesScreen = document.getElementById('categories-screen');
        const loadingScreen = document.getElementById('loading-screen');
        const quizScreen = document.getElementById('quiz-screen');
        const resultsScreen = document.getElementById('results-screen');

        // Quiz elements
        const timerElement = document.getElementById('timer');
        const questionCounterElement = document.getElementById('question-counter');
        const progressBarElement = document.getElementById('progress-bar');
        const progressPercentElement = document.getElementById('progress-percent');
        const questionTextElement = document.getElementById('question-text');
        const optionsContainerElement = document.getElementById('options-container');
        const nextButtonElement = document.getElementById('next-btn');

        // Result elements
        const scoreTextElement = document.getElementById('score-text');
        const percentageTextElement = document.getElementById('percentage-text');
        const resultMessageElement = document.getElementById('result-message');
        const correctAnswersElement = document.getElementById('correct-answers');
        const wrongAnswersElement = document.getElementById('wrong-answers');
        const resultIconElement = document.getElementById('result-icon');

        // Seed questions if collection is empty
        function seedQuestionsIfNeeded() {
            const today = new Date().toISOString().split('T')[0];
            
            // Check if questions already exist for today
            db.collection('questions')
                .where('date', '==', today)
                .get()
                .then(snapshot => {
                    if (snapshot.empty) {
                        // No questions for today, seed the database
                        seedQuestions();
                    } else {
                        console.log('Questions already exist for today');
                    }
                })
                .catch(error => {
                    console.error('Error checking questions:', error);
                });
        }

        // Seed questions into Firestore
        function seedQuestions() {
            const today = new Date().toISOString().split('T')[0];
            const batch = db.batch();
            
            // MDCAT Questions (Biology, Physics, Chemistry, English)
            const mdcatQuestions = [
                // Biology Questions
                {
                    category: "MDCAT",
                    date: today,
                    questionNumber: 1,
                    question: "Which of the following is the basic unit of life?",
                    options: ["Cell", "Tissue", "Organ", "System"],
                    correctAnswer: "Cell"
                },
                {
                    category: "MDCAT",
                    date: today,
                    questionNumber: 2,
                    question: "Photosynthesis occurs in which part of the plant cell?",
                    options: ["Mitochondria", "Nucleus", "Chloroplast", "Ribosome"],
                    correctAnswer: "Chloroplast"
                },
                {
                    category: "MDCAT",
                    date: today,
                    questionNumber: 3,
                    question: "Which blood type is known as the universal donor?",
                    options: ["A", "B", "AB", "O"],
                    correctAnswer: "O"
                },
                {
                    category: "MDCAT",
                    date: today,
                    questionNumber: 4,
                    question: "The human heart has how many chambers?",
                    options: ["2", "3", "4", "5"],
                    correctAnswer: "4"
                },
                {
                    category: "MDCAT",
                    date: today,
                    questionNumber: 5,
                    question: "Which organ produces insulin?",
                    options: ["Liver", "Pancreas", "Kidney", "Stomach"],
                    correctAnswer: "Pancreas"
                },
                // Physics Questions
                {
                    category: "MDCAT",
                    date: today,
                    questionNumber: 6,
                    question: "What is the SI unit of force?",
                    options: ["Joule", "Newton", "Watt", "Pascal"],
                    correctAnswer: "Newton"
                },
                {
                    category: "MDCAT",
                    date: today,
                    questionNumber: 7,
                    question: "Which law states that every action has an equal and opposite reaction?",
                    options: ["Newton's First Law", "Newton's Second Law", "Newton's Third Law", "Law of Gravitation"],
                    correctAnswer: "Newton's Third Law"
                },
                {
                    category: "MDCAT",
                    date: today,
                    questionNumber: 8,
                    question: "What is the speed of light in a vacuum?",
                    options: ["3 × 10^6 m/s", "3 × 10^8 m/s", "3 × 10^10 m/s", "3 × 10^12 m/s"],
                    correctAnswer: "3 × 10^8 m/s"
                },
                {
                    category: "MDCAT",
                    date: today,
                    questionNumber: 9,
                    question: "Which lens is used to correct myopia?",
                    options: ["Convex", "Concave", "Bifocal", "Cylindrical"],
                    correctAnswer: "Concave"
                },
                {
                    category: "MDCAT",
                    date: today,
                    questionNumber: 10,
                    question: "What is the unit of electric current?",
                    options: ["Volt", "Ampere", "Ohm", "Watt"],
                    correctAnswer: "Ampere"
                },
                // Chemistry Questions
                {
                    category: "MDCAT",
                    date: today,
                    questionNumber: 11,
                    question: "What is the atomic number of carbon?",
                    options: ["6", "12", "14", "16"],
                    correctAnswer: "6"
                },
                {
                    category: "MDCAT",
                    date: today,
                    questionNumber: 12,
                    question: "Which gas is known as laughing gas?",
                    options: ["Oxygen", "Nitrogen", "Nitrous Oxide", "Carbon Dioxide"],
                    correctAnswer: "Nitrous Oxide"
                },
                {
                    category: "MDCAT",
                    date: today,
                    questionNumber: 13,
                    question: "What is the pH of pure water?",
                    options: ["5", "6", "7", "8"],
                    correctAnswer: "7"
                },
                {
                    category: "MDCAT",
                    date: today,
                    questionNumber: 14,
                    question: "Which element is the most abundant in the Earth's crust?",
                    options: ["Oxygen", "Silicon", "Aluminum", "Iron"],
                    correctAnswer: "Oxygen"
                },
                {
                    category: "MDCAT",
                    date: today,
                    questionNumber: 15,
                    question: "What is the chemical formula of table salt?",
                    options: ["NaCl", "KCl", "CaCl2", "MgCl2"],
                    correctAnswer: "NaCl"
                },
                // English Questions
                {
                    category: "MDCAT",
                    date: today,
                    questionNumber: 16,
                    question: "Choose the correct synonym for 'Benevolent'",
                    options: ["Kind", "Cruel", "Selfish", "Greedy"],
                    correctAnswer: "Kind"
                },
                {
                    category: "MDCAT",
                    date: today,
                    questionNumber: 17,
                    question: "Which sentence is grammatically correct?",
                    options: ["She don't like apples", "She doesn't like apples", "She didn't likes apples", "She not like apples"],
                    correctAnswer: "She doesn't like apples"
                },
                {
                    category: "MDCAT",
                    date: today,
                    questionNumber: 18,
                    question: "What is the plural of 'child'?",
                    options: ["Childs", "Childes", "Children", "Child's"],
                    correctAnswer: "Children"
                },
                {
                    category: "MDCAT",
                    date: today,
                    questionNumber: 19,
                    question: "Identify the correct passive voice: 'They built this house in 1990.'",
                    options: ["This house was built in 1990 by them", "This house is built in 1990 by them", "This house built in 1990 by them", "This house has been built in 1990 by them"],
                    correctAnswer: "This house was built in 1990 by them"
                },
                {
                    category: "MDCAT",
                    date: today,
                    questionNumber: 20,
                    question: "Choose the correct antonym for 'Ancient'",
                    options: ["Old", "Modern", "Historic", "Traditional"],
                    correctAnswer: "Modern"
                }
                // Add more MDCAT questions to reach 50...
            ];

            // ECAT Questions (Physics, Chemistry, Mathematics, English)
            const ecatQuestions = [
                // Physics Questions
                {
                    category: "ECAT",
                    date: today,
                    questionNumber: 1,
                    question: "What is the formula for force?",
                    options: ["F = m/a", "F = m × a", "F = m + a", "F = m - a"],
                    correctAnswer: "F = m × a"
                },
                {
                    category: "ECAT",
                    date: today,
                    questionNumber: 2,
                    question: "Which of the following is a vector quantity?",
                    options: ["Mass", "Time", "Velocity", "Temperature"],
                    correctAnswer: "Velocity"
                },
                {
                    category: "ECAT",
                    date: today,
                    questionNumber: 3,
                    question: "What is the unit of energy?",
                    options: ["Newton", "Joule", "Watt", "Pascal"],
                    correctAnswer: "Joule"
                },
                {
                    category: "ECAT",
                    date: today,
                    questionNumber: 4,
                    question: "Which law relates pressure and volume at constant temperature?",
                    options: ["Charles's Law", "Boyle's Law", "Gay-Lussac's Law", "Avogadro's Law"],
                    correctAnswer: "Boyle's Law"
                },
                {
                    category: "ECAT",
                    date: today,
                    questionNumber: 5,
                    question: "What is the SI unit of power?",
                    options: ["Joule", "Watt", "Newton", "Volt"],
                    correctAnswer: "Watt"
                },
                // Chemistry Questions
                {
                    category: "ECAT",
                    date: today,
                    questionNumber: 6,
                    question: "What is the valency of oxygen?",
                    options: ["1", "2", "3", "4"],
                    correctAnswer: "2"
                },
                {
                    category: "ECAT",
                    date: today,
                    questionNumber: 7,
                    question: "Which of the following is a noble gas?",
                    options: ["Oxygen", "Nitrogen", "Helium", "Chlorine"],
                    correctAnswer: "Helium"
                },
                {
                    category: "ECAT",
                    date: today,
                    questionNumber: 8,
                    question: "What is the chemical formula of water?",
                    options: ["H2O", "HO2", "H2O2", "H3O"],
                    correctAnswer: "H2O"
                },
                {
                    category: "ECAT",
                    date: today,
                    questionNumber: 9,
                    question: "Which acid is found in vinegar?",
                    options: ["Hydrochloric acid", "Sulfuric acid", "Acetic acid", "Nitric acid"],
                    correctAnswer: "Acetic acid"
                },
                {
                    category: "ECAT",
                    date: today,
                    questionNumber: 10,
                    question: "What is the atomic number of hydrogen?",
                    options: ["1", "2", "3", "4"],
                    correctAnswer: "1"
                },
                // Mathematics Questions
                {
                    category: "ECAT",
                    date: today,
                    questionNumber: 11,
                    question: "What is the value of π (pi) approximately?",
                    options: ["3.12", "3.14", "3.16", "3.18"],
                    correctAnswer: "3.14"
                },
                {
                    category: "ECAT",
                    date: today,
                    questionNumber: 12,
                    question: "What is the derivative of x²?",
                    options: ["x", "2x", "x²", "2x²"],
                    correctAnswer: "2x"
                },
                {
                    category: "ECAT",
                    date: today,
                    questionNumber: 13,
                    question: "Solve for x: 2x + 5 = 15",
                    options: ["5", "10", "15", "20"],
                    correctAnswer: "5"
                },
                {
                    category: "ECAT",
                    date: today,
                    questionNumber: 14,
                    question: "What is the area of a circle with radius 7?",
                    options: ["49π", "14π", "28π", "7π"],
                    correctAnswer: "49π"
                },
                {
                    category: "ECAT",
                    date: today,
                    questionNumber: 15,
                    question: "What is the value of sin(90°)?",
                    options: ["0", "0.5", "1", "Undefined"],
                    correctAnswer: "1"
                },
                // English Questions
                {
                    category: "ECAT",
                    date: today,
                    questionNumber: 16,
                    question: "Choose the correct synonym for 'Diligent'",
                    options: ["Lazy", "Hardworking", "Careless", "Slow"],
                    correctAnswer: "Hardworking"
                },
                {
                    category: "ECAT",
                    date: today,
                    questionNumber: 17,
                    question: "Which sentence is in the past perfect tense?",
                    options: ["She had finished her work", "She finishes her work", "She is finishing her work", "She will finish her work"],
                    correctAnswer: "She had finished her work"
                },
                {
                    category: "ECAT",
                    date: today,
                    questionNumber: 18,
                    question: "What is the plural of 'analysis'?",
                    options: ["Analyses", "Analysises", "Analysises", "Analysis"],
                    correctAnswer: "Analyses"
                },
                {
                    category: "ECAT",
                    date: today,
                    questionNumber: 19,
                    question: "Identify the correct direct speech: He said that he was tired.",
                    options: ["He said, 'I am tired.'", "He said, 'I was tired.'", "He said, 'He is tired.'", "He said, 'He was tired.'"],
                    correctAnswer: "He said, 'I am tired.'"
                },
                {
                    category: "ECAT",
                    date: today,
                    questionNumber: 20,
                    question: "Choose the correct antonym for 'Generous'",
                    options: ["Kind", "Stingy", "Charitable", "Benevolent"],
                    correctAnswer: "Stingy"
                }
                // Add more ECAT questions to reach 50...
            ];

            // Add MDCAT questions to batch
            mdcatQuestions.forEach((question, index) => {
                const docRef = db.collection('questions').doc(`MDCAT_${today}_${index + 1}`);
                batch.set(docRef, question);
            });

            // Add ECAT questions to batch
            ecatQuestions.forEach((question, index) => {
                const docRef = db.collection('questions').doc(`ECAT_${today}_${index + 1}`);
                batch.set(docRef, question);
            });

            // Commit the batch
            batch.commit()
                .then(() => {
                    console.log('Questions seeded successfully');
                })
                .catch(error => {
                    console.error('Error seeding questions:', error);
                });
        }

        // Open quiz based on selected category
        function openQuiz(category) {
            currentCategory = category;
            categoriesScreen.style.display = 'none';
            loadingScreen.style.display = 'block';
            
            // Fetch questions from Firestore for today's date
            fetchQuestions();
        }

        // Fetch questions from Firestore
        function fetchQuestions() {
            const today = new Date().toISOString().split('T')[0]; // YYYY-MM-DD format
            
            // Real-time listener for questions
            const unsubscribe = db.collection('questions')
                .where('category', '==', currentCategory)
                .where('date', '==', today)
                .orderBy('questionNumber')
                .limit(50)
                .onSnapshot(snapshot => {
                    questions = [];
                    snapshot.forEach(doc => {
                        questions.push({
                            id: doc.id,
                            ...doc.data()
                        });
                    });
                    
                    if (questions.length > 0) {
                        // Questions found, start the quiz
                        loadingScreen.style.display = 'none';
                        quizScreen.style.display = 'block';
                        startQuiz();
                    } else {
                        // No questions found for today
                        loadingScreen.innerHTML = `
                            <div class="result-icon">📚</div>
                            <h3>No Questions Available</h3>
                            <p>No questions found for ${currentCategory} today. Please check back tomorrow.</p>
                            <button class="result-btn back-btn" onclick="backToCategories()" style="margin-top: 20px;">Back to Categories</button>
                        `;
                    }
                }, error => {
                    console.error('Error fetching questions:', error);
                    loadingScreen.innerHTML = `
                        <div class="result-icon">❌</div>
                        <h3>Error Loading Questions</h3>
                        <p>There was an error fetching the questions. Please check your connection and try again.</p>
                        <button class="result-btn back-btn" onclick="backToCategories()" style="margin-top: 20px;">Back to Categories</button>
                    `;
                });
        }

        // Start the quiz
        function startQuiz() {
            currentQuestionIndex = 0;
            userAnswers = new Array(questions.length).fill(null);
            timeLeft = 15 * 60; // Reset timer to 15 minutes
            
            // Start the countdown timer
            startTimer();
            
            // Display the first question
            displayQuestion();
        }

        // Start the countdown timer
        function startTimer() {
            clearInterval(timerInterval);
            
            timerInterval = setInterval(() => {
                timeLeft--;
                
                // Update timer display
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                timerElement.textContent = `⏱️ ${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                
                // Change color when time is running low
                if (timeLeft <= 300) { // 5 minutes or less
                    timerElement.style.color = '#ef4444';
                    timerElement.style.background = '#fef2f2';
                }
                
                // Auto-submit when time is up
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    submitQuiz();
                }
            }, 1000);
        }

        // Display the current question
        function displayQuestion() {
            const question = questions[currentQuestionIndex];
            
            // Update question counter
            questionCounterElement.textContent = `Question ${currentQuestionIndex + 1} of ${questions.length}`;
            
            // Update progress bar
            const progress = ((currentQuestionIndex + 1) / questions.length) * 100;
            progressBarElement.style.width = `${progress}%`;
            progressPercentElement.textContent = `${Math.round(progress)}%`;
            
            // Update question text
            questionTextElement.textContent = question.question;
            
            // Clear previous options
            optionsContainerElement.innerHTML = '';
            
            // Create option elements
            question.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'option';
                if (userAnswers[currentQuestionIndex] === index) {
                    optionElement.classList.add('selected');
                }
                optionElement.textContent = option;
                optionElement.onclick = () => selectOption(index);
                optionsContainerElement.appendChild(optionElement);
            });
            
            // Update next button text
            if (currentQuestionIndex === questions.length - 1) {
                nextButtonElement.textContent = 'Submit Quiz';
                nextButtonElement.classList.add('submit-btn');
            } else {
                nextButtonElement.textContent = 'Next Question';
                nextButtonElement.classList.remove('submit-btn');
            }
        }

        // Select an option
        function selectOption(optionIndex) {
            // Remove selected class from all options
            const options = document.querySelectorAll('.option');
            options.forEach(option => option.classList.remove('selected'));
            
            // Add selected class to clicked option
            options[optionIndex].classList.add('selected');
            
            // Save user's answer
            userAnswers[currentQuestionIndex] = optionIndex;
        }

        // Move to next question or submit quiz
        function nextQuestion() {
            // If it's the last question, submit the quiz
            if (currentQuestionIndex === questions.length - 1) {
                submitQuiz();
                return;
            }
            
            // Move to next question
            currentQuestionIndex++;
            displayQuestion();
        }

        // Submit the quiz and show results
        function submitQuiz() {
            clearInterval(timerInterval);
            
            // Calculate results
            let correctCount = 0;
            let wrongCount = 0;
            
            questions.forEach((question, index) => {
                if (userAnswers[index] !== null) {
                    const userAnswer = question.options[userAnswers[index]];
                    if (userAnswer === question.correctAnswer) {
                        correctCount++;
                    } else {
                        wrongCount++;
                    }
                } else {
                    // Count unanswered questions as wrong
                    wrongCount++;
                }
            });
            
            const percentage = Math.round((correctCount / questions.length) * 100);
            
            // Update result elements
            scoreTextElement.textContent = `${correctCount}/${questions.length}`;
            percentageTextElement.textContent = `${percentage}%`;
            correctAnswersElement.textContent = correctCount;
            wrongAnswersElement.textContent = wrongCount;
            
            // Set result message based on performance
            if (percentage >= 80) {
                resultMessageElement.textContent = 'Excellent! You\'re well prepared! 🎉';
                resultIconElement.textContent = '🏆';
            } else if (percentage >= 60) {
                resultMessageElement.textContent = 'Good job! Keep practicing! 👍';
                resultIconElement.textContent = '✨';
            } else if (percentage >= 40) {
                resultMessageElement.textContent = 'Not bad! Review the topics and try again! 📚';
                resultIconElement.textContent = '📖';
            } else {
                resultMessageElement.textContent = 'Keep practicing! You can do better! 💪';
                resultIconElement.textContent = '🔥';
            }
            
            // Show results screen
            quizScreen.style.display = 'none';
            resultsScreen.style.display = 'block';
        }

        // Retry the quiz
        function retryQuiz() {
            resultsScreen.style.display = 'none';
            quizScreen.style.display = 'block';
            startQuiz();
        }

        // Go back to categories screen
        function backToCategories() {
            clearInterval(timerInterval);
            quizScreen.style.display = 'none';
            resultsScreen.style.display = 'none';
            loadingScreen.style.display = 'none';
            categoriesScreen.style.display = 'block';
            
            // Reset loading screen
            loadingScreen.innerHTML = `
                <div class="spinner"></div>
                <h3>Loading Today's Questions</h3>
                <p>Please wait while we fetch the latest quiz...</p>
            `;
        }

        // Share result functionality
        document.querySelector('.share-btn').addEventListener('click', function() {
            const score = document.getElementById('score-text').textContent;
            const percentage = document.getElementById('percentage-text').textContent;
            
            if (navigator.share) {
                navigator.share({
                    title: 'My Quiz Result',
                    text: `I scored ${score} (${percentage}) on the ${currentCategory} quiz!`,
                    url: window.location.href
                });
            } else {
                // Fallback for browsers that don't support Web Share API
                alert(`Share your result: I scored ${score} (${percentage}) on the ${currentCategory} quiz!`);
            }
        });

        // Initialize the app
        window.onload = function() {
            // Seed questions if needed
            seedQuestionsIfNeeded();
        };
    </script>
</body>
</html>